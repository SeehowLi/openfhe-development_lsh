# 功能开发日志

## 日志模板

2025-07-07是第一次写开发日志，用于记录

### 日期：2025-07-07

**功能名称**：[离散CKKS的实现]
 **开发时长**：[X小时]

#### 完成内容

- [x] 增加调试功能记录文件
- [x] 增加AI总结代码生成文件
- [x] 增加DISCRETECKKS的Enable开启标志位
- [x] 完成CtS和StC的的CryptoContext的全局调用(cc->EvalCtS/EvalStC)
- [x] 实现的StC和CtS的具体功能

#### 学到的经验

1. OpenFHE的错误处理机制比想象中复杂，需要仔细处理异常传播
2. 在头文件中使用 `inline` 可以避免多重定义错误
3. 日志系统最好设计成可配置的，方便在不同场景下使用

#### 下一步计划

- [ ] 为日志系统编写完整的单元测试
- [ ] 实现日志文件轮转功能
- [ ] 添加性能分析宏，自动记录函数执行时间

#### 今日总结

成功实现了基础日志功能，能够满足调试需求。明天计划添加更高级的功能，如日志轮转和性能统计。



## 执行步骤：

### 1. 首先创建脚本文件

在你的OpenFHE项目根目录下，创建一个名为 `smart_collect.sh` 的文件，把下面的内容复制进去：

bash

```bash
#!/bin/bash

# 创建输出目录
mkdir -p code_chunks

echo "Starting code collection for OpenFHE project..."

# 1. 项目概览和摘要
echo "Creating project summary..."
> code_chunks/0_summary.txt
echo "====== OPENFHE PROJECT SUMMARY ======" >> code_chunks/0_summary.txt
echo -e "\nGenerated on: $(date)" >> code_chunks/0_summary.txt
echo -e "\n=== Directory Structure ===" >> code_chunks/0_summary.txt
find . -type d -name ".git" -prune -o -type d -name "build" -prune -o -type d -print | head -50 | sed 's|[^/]*/|- |g' >> code_chunks/0_summary.txt

echo -e "\n\n=== File Statistics ===" >> code_chunks/0_summary.txt
echo "Header files (.h, .hpp):" >> code_chunks/0_summary.txt
find . -name "*.h" -o -name "*.hpp" | grep -v "build\|\.git" | wc -l >> code_chunks/0_summary.txt
echo "Source files (.cpp):" >> code_chunks/0_summary.txt
find . -name "*.cpp" | grep -v "build\|\.git" | wc -l >> code_chunks/0_summary.txt

echo -e "\n\n=== Core Header Files ===" >> code_chunks/0_summary.txt
find . \( -name "*.h" -o -name "*.hpp" \) -path "*/src/*" -o -path "*/include/*" | grep -v "build\|\.git" | sort >> code_chunks/0_summary.txt

# 2. 核心头文件（类定义和接口）
echo "Collecting headers and interfaces..."
> code_chunks/1_headers_and_interfaces.txt
echo "====== CORE HEADERS AND INTERFACES ======" >> code_chunks/1_headers_and_interfaces.txt
echo "Generated on: $(date)" >> code_chunks/1_headers_and_interfaces.txt

find . \( -name "*.h" -o -name "*.hpp" \) | grep -v "build\|\.git\|test" | sort | while read -r file; do
    echo -e "\n\n//========================================" >> code_chunks/1_headers_and_interfaces.txt
    echo "//===== File: $file =====" >> code_chunks/1_headers_and_interfaces.txt
    echo "//========================================" >> code_chunks/1_headers_and_interfaces.txt
    
    # 提取关键内容：类定义、重要函数声明等
    cat "$file" | grep -E -A3 -B1 "^[[:space:]]*(template|class|struct|enum|typedef|namespace|public:|protected:|private:|virtual|static|explicit)" | grep -v "^--$" >> code_chunks/1_headers_and_interfaces.txt
done

# 3. 实现文件摘要
echo "Collecting implementation signatures..."
> code_chunks/2_implementations.txt
echo "====== KEY IMPLEMENTATIONS ======" >> code_chunks/2_implementations.txt
echo "Generated on: $(date)" >> code_chunks/2_implementations.txt

find . -name "*.cpp" | grep -v "build\|\.git\|test\|example" | sort | while read -r file; do
    # 检查文件是否有实质内容
    if [ -s "$file" ]; then
        echo -e "\n\n//===== File: $file =====" >> code_chunks/2_implementations.txt
        # 提取函数实现签名和重要的类方法
        grep -E "^[[:space:]]*[a-zA-Z_][a-zA-Z0-9_:<>]*::[a-zA-Z_][a-zA-Z0-9_]*\s*\(" "$file" | head -20 >> code_chunks/2_implementations.txt
    fi
done

# 4. CMake和构建配置
echo "Collecting build configurations..."
> code_chunks/3_build_config.txt
echo "====== BUILD CONFIGURATION ======" >> code_chunks/3_build_config.txt
echo "Generated on: $(date)" >> code_chunks/3_build_config.txt

# 主CMakeLists.txt
if [ -f "CMakeLists.txt" ]; then
    echo -e "\n//===== Main CMakeLists.txt =====" >> code_chunks/3_build_config.txt
    cat CMakeLists.txt >> code_chunks/3_build_config.txt
fi

# 其他CMake文件
find . -name "*.cmake" -o -name "CMakeLists.txt" | grep -v "build\|\.git" | grep -v "^./CMakeLists.txt$" | while read -r file; do
    echo -e "\n\n//===== $file =====" >> code_chunks/3_build_config.txt
    cat "$file" >> code_chunks/3_build_config.txt
done

# 5. 创建关键算法文件列表（OpenFHE特定）
echo "Identifying key OpenFHE components..."
> code_chunks/4_key_algorithms.txt
echo "====== KEY OPENFHE ALGORITHMS ======" >> code_chunks/4_key_algorithms.txt

# 查找关键的加密算法实现
for keyword in "BGV" "BFV" "CKKS" "TFHE" "scheme" "crypto" "lattice" "encrypt" "decrypt" "key"; do
    echo -e "\n=== Files containing '$keyword' ===" >> code_chunks/4_key_algorithms.txt
    find . \( -name "*.h" -o -name "*.hpp" -o -name "*.cpp" \) | xargs grep -l "$keyword" 2>/dev/null | grep -v "build\|\.git" | head -10 >> code_chunks/4_key_algorithms.txt
done

# 生成文件大小报告
echo -e "\n\n=== Generated file sizes ===" 
ls -lh code_chunks/

echo -e "\nCode collection complete! Files are in ./code_chunks/"
echo "You can now upload these files one by one, starting with 0_summary.txt"
```

### 2. 使用Git Bash运行脚本

bash

```bash
# 给脚本添加执行权限
chmod +x smart_collect.sh

# 运行脚本
./smart_collect.sh
```

### 3. 如果遇到问题，试试这个简化版本

如果上面的脚本有问题，创建一个 `simple_collect.sh`：

bash

```bash
#!/bin/bash

mkdir -p code_chunks

# 简单版本 - 只收集核心内容
echo "====== PROJECT OVERVIEW ======" > code_chunks/summary.txt
find . -name "*.h" -o -name "*.hpp" | grep -v build | head -30 >> code_chunks/summary.txt

echo "====== MAIN HEADERS ======" > code_chunks/headers.txt
find . -name "*.h" -o -name "*.hpp" | grep -v build | xargs cat >> code_chunks/headers.txt

echo "Done! Check code_chunks folder"
```

### 4. 运行后的预期结果

运行成功后，你会在 `code_chunks` 目录下看到这些文件：

- `0_summary.txt` - 项目概览（先上传这个）
- `1_headers_and_interfaces.txt` - 接口定义
- `2_implementations.txt` - 实现摘要
- `3_build_config.txt` - 构建配置
- `4_key_algorithms.txt` - 关键算法文件列表

### 5. 上传顺序建议

1. 先上传 `0_summary.txt`，让我了解项目整体结构
2. 然后根据你想讨论的具体问题，选择性上传其他文件

现在就试试运行脚本吧！如果遇到任何错误信息，把错误贴给我，我来帮你调整脚本。

